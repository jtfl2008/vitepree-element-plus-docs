import{n as b,W as y,as as S,at as M,o as q,d as w,b as C,k as D,a,u as E,F as R,r as n,aq as B,au as A}from"../app.c209622b.js";function f(u){return typeof u=="function"||Object.prototype.toString.call(u)==="[object Object]"&&!A(u)}var W={__name:"pro-form",props:{modelValue:{required:!0,type:Object,default:()=>({})},fields:{required:!0,type:Array,default:()=>[]},rules:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(u,{expose:h,emit:F}){const{modelValue:s,fields:g,rules:k,isQuery:L}=u;let p=b({}),v=b(null),V=y(()=>g.filter(e=>!e.hidden)),m=y(()=>g.reduce((e,t)=>(t.groups?t.groups.forEach(l=>{e.push(l)}):e.push(t),e),[])),_=(e,t)=>Object.keys(e).filter(l=>!t.includes(l)).reduce((l,r)=>(l[r]=e[r],l),{}),x=()=>m.value.reduce((e,t)=>{let l=s[t.prop]||"";return s[t.prop]!==void 0?e[t.prop]=s[t.prop]:(t.component==="checkbox-group"||t.component==="select"&&t.multiple||t.component==="tree-select"&&t.multiple||t.component==="date-picker"&&t.type==="daterange"?l=[]:(t.component==="slider"||t.component==="input-number")&&(l=0),e[t.prop]=l),e},{});p.value=x(),S(()=>p,e=>{let t={};if(!m.value.some(r=>["daterange"].includes(r.type)))t=e.value;else{let r=m.value.find(N=>N.type==="daterange"),o=r.propsMap,i=o[0],I=o[1];t={...e.value,[i]:e.value[r.prop][0],[I]:e.value[r.prop][1]},t=_(t,[r.prop])}F("update:modelValue",t)},{deep:!0,immediate:!0});let j=()=>{let e;return a(n("el-form"),{model:p.value,rules:k,inline:!0,class:"pro-form"},f(e=O())?e:{default:()=>[e]})},d=M(),O=()=>a(n("el-row"),null,{default:()=>[V.value.map(e=>{if(e.span){let t;return a(n("el-col"),{span:e.span},f(t=c(e))?t:{default:()=>[t]})}return c(e)}),d&&d.default&&d.default()]}),c=e=>{if(e.groups&&e.groups.length){let t;return a(n("el-card"),{header:e.title},f(t=e.groups.map(l=>c(l)))?t:{default:()=>[t]})}else{let{component:t,options:l,...r}=e,o="el-"+e.component;return t=n(o),a(n("el-form-item"),{label:e.label,prop:e.prop},{default:()=>[a(t,B({modelValue:p.value[e.prop],"onUpdate:modelValue":i=>p.value[e.prop]=i},r),{default:()=>[l&&l.length&&P(e,l)]})]})}},P=(e,t)=>{let l="";e.component==="select"?l="el-option":e.component==="checkbox-group"?l="el-checkbox":e.component==="radio-group"&&(l="el-radio");let r=n(l);return t.map(o=>e.component==="checkbox-group"||e.component==="radio-group"?a(r,{label:o.value,key:o.value},{default:()=>[o.label]}):a(r,{label:o.label,value:o.value,key:o.value},null))};return h({validate:async()=>new Promise(e=>{v.value.validate(t=>{t&&e(t)})}),resetFields:()=>{v.value.resetFields()}}),(e,t)=>(q(),w(R,null,[C(D(u.modelValue)+" ",1),a(E(j))],64))}};export{W as _};
