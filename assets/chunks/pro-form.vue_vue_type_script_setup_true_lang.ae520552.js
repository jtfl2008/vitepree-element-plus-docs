import{n as v,W as b,aq as M,o as N,c as w,u as C,a,r as n,ar as R,as as S}from"../app.5ad9d4dc.js";function s(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!S(p)}var q={__name:"pro-form",props:{modelValue:{type:Object,default:()=>({})},fields:{type:Array,default:()=>[]},rules:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(p,{expose:h,emit:y}){const{modelValue:m,fields:f,rules:_}=p;let u=v({}),g=v(null),k=b(()=>f.filter(e=>!e.hidden)),d=b(()=>f.reduce((e,t)=>(t.groups?t.groups.forEach(l=>{e.push(l)}):e.push(t),e),[])),F=(e,t)=>Object.keys(e).filter(l=>!t.includes(l)).reduce((l,o)=>(l[o]=e[o],l),{}),V=()=>d.value.reduce((e,t)=>{let l=m[t.prop]||"";return m[t.prop]!==void 0?e[t.prop]=m[t.prop]:(t.component==="checkbox-group"||t.component==="select"&&t.multiple||t.component==="tree-select"&&t.multiple||t.component==="date-picker"&&t.type==="daterange"?l=[]:(t.component==="slider"||t.component==="input-number")&&(l=0),e[t.prop]=l),e},{});u.value=V(),M(()=>u,e=>{let t={};if(!d.value.some(o=>["daterange"].includes(o.type)))t=e.value;else{let o=d.value.find(I=>I.type==="daterange"),r=o.propsMap,i=r[0],P=r[1];t={...e.value,[i]:e.value[o.prop][0],[P]:e.value[o.prop][1]},t=F(t,[o.prop])}y("update:modelValue",t)},{deep:!0});let j=()=>{let e;return a(n("el-form"),{model:u,rules:_,inline:!0,class:"pro-form"},s(e=x())?e:{default:()=>[e]})},x=()=>{let e;return a(n("el-row"),null,s(e=k.value.map(t=>{if(t.span){let l;return a(n("el-col"),{span:t.span},s(l=c(t))?l:{default:()=>[l]})}return c(t)}))?e:{default:()=>[e]})},c=e=>{if(e.groups&&e.groups.length){let t;return a(n("el-card"),{header:e.title},s(t=e.groups.map(l=>c(l)))?t:{default:()=>[t]})}else{let{component:t,options:l,...o}=e,r="el-"+e.component;return t=n(r),a(n("el-form-item"),{label:e.label,prop:e.prop},{default:()=>[a(t,R({modelValue:u.value[e.prop],"onUpdate:modelValue":i=>u.value[e.prop]=i},o),{default:()=>[l&&l.length&&O(e,l)]})]})}},O=(e,t)=>{let l="";e.component==="select"?l="el-option":e.component==="checkbox-group"?l="el-checkbox":e.component==="radio-group"&&(l="el-radio");let o=n(l);return t.map(r=>e.component==="checkbox-group"||e.component==="radio-group"?a(o,{label:r.value,key:r.value},{default:()=>[r.label]}):a(o,{label:r.label,value:r.value,key:r.value},null))};return h({validate:async()=>new Promise(e=>{g.value.validate(t=>{t&&e(t)})}),resetFields:()=>{g.value.resetFields()}}),(e,t)=>(N(),w(C(j)))}};export{q as _};
